@use 'sass:map';
@use 'sass:string';
@use 'sass:list';

@use 'functions' as f;
@use './variables/colors' as c;
@use './variables/spacing' as s;
@use './variables/radius' as r;
@use './variables/shadows' as sh;
@use './variables/typography' as t;

// --------------------------------------------------
// Derived color maps
// --------------------------------------------------

// Roles that has scales
$color-scale-roles: ("primary", "secondary", "accent") !default;

// Brand role map (base roles)
$brand-colors: (
  "primary": c.$color-primary,
  "secondary": c.$color-secondary,
  "accent": c.$color-accent,
  "link": c.$color-link
) !default;

// Optional: include semantic states in the master map too (no scales)
$semantic-colors: (
  "body-bg": c.$color-body-bg,
  "surface": c.$color-surface,
  "body-text": c.$color-body-text,
  "muted": c.$color-muted,
  "border": c.$color-border,
  "border-hover": c.$color-border-hover,
  "link-hover": c.$color-link-hover,
  "success": c.$color-success,
  "info": c.$color-info,
  "warning": c.$color-warning,
  "danger": c.$color-danger,
  "white": c.$color-fill-white,
  "black": c.$color-fill-black
) !default;

// Full colors map = brand + semantic + generated scales
$colors: map.merge($brand-colors, $semantic-colors);

@each $name, $value in $brand-colors {
  @if list.index($color-scale-roles, $name) != null {
    $scale: f.color-scale($value);

    @each $step, $scaled in $scale {
      $colors: map.merge($colors, ("#{$name}-#{$step}": $scaled));
    }
  }
}

// --------------------------------------------------
// Derived Spacing + radius maps
// --------------------------------------------------
$spacers: f.scale-to-map(s.$spacing-multipliers, s.$default-spacer);
$radiuses: f.scale-to-map(r.$radius-multipliers, r.$radius-base);

// // --------------------------------------------------
// // Derived Typography
// // --------------------------------------------------
// $font-weights-map: f.list-to-map(t.$font-weights);

// --------------------------------------------------
// CSS var mirror maps - Public runtime token surface
// --------------------------------------------------
@function css-var-map($m, $prefix) {
  $out: ();
  @each $name, $value in $m {
    $out: map.merge($out, ($name: string.unquote("var(--#{$prefix}-#{$name})")));
  }
  @return $out;
}

// This is the one utilities should consume:
$colors-css: css-var-map($colors, "color");
$spacers-css: css-var-map($spacers, "space");
$spacers-css-auto: css-var-map(map.merge($spacers, (auto: auto)), "space");
$radiuses-css: css-var-map($radiuses, "radius");
$shadows-css: css-var-map(sh.$shadows, "shadow"); // if you keep $shadows as a map